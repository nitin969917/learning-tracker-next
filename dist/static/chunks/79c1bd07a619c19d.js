(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,66895,e=>{"use strict";var a=e.i(43476),l=e.i(71645),s=e.i(63394);function i(){let{user:e,logout:i,refetchUser:r}=(0,s.useAuth)(),[t,n]=(0,l.useState)(null),[o,c]=(0,l.useState)(!0),[d,u]=(0,l.useState)(!1),[m,p]=(0,l.useState)(!1),[h,f]=(0,l.useState)(""),[g,j]=(0,l.useState)(""),[x,v]=(0,l.useState)(null),[N,y]=(0,l.useState)(null),[_,b]=(0,l.useState)(!1),[S,C]=(0,l.useState)(!1),[w,P]=(0,l.useState)(""),[k,U]=(0,l.useState)({degree:"",institution:"",graduation_year:"",field_of_study:"",current_level:""});(0,l.useEffect)(()=>{D()},[]);let D=async()=>{try{let e=await fetch("/api/auth/profile");if(!e.ok)throw Error("Failed to load profile");let a=(await e.json()).user;n(a),P(a.username||""),U({degree:a.degree||"",institution:a.institution||"",graduation_year:a.graduation_year||"",field_of_study:a.field_of_study||"",current_level:a.current_level||""}),a.profile_picture?y(a.profile_picture):y(null)}catch(e){f("Failed to load profile"),console.error(e)}finally{c(!1)}},E=async()=>{if(window.confirm("Are you sure you want to remove your profile picture?")){b(!0),f("");try{let e=await fetch("/api/auth/profile/picture",{method:"DELETE"});if(!e.ok)throw Error("Failed to delete profile picture");let a=await e.json();n(a.user),y(null),v(null),j("Profile picture removed successfully!"),setTimeout(()=>j(""),3e3)}catch(e){f(e.message)}finally{b(!1)}}},T=async()=>{if(!x)return void f("Please select an image first");f(""),j(""),p(!0);try{let e=new FormData;e.append("profile_picture",x);let a=await fetch("/api/auth/profile",{method:"PUT",body:e});if(!a.ok)throw Error("Failed to upload image");let l=await a.json();n(l.user),v(null),l.user.profile_picture&&y(l.user.profile_picture),j("Profile picture updated successfully!"),setTimeout(()=>j(""),3e3)}catch(e){console.error("Upload error:",e),f(e.message)}finally{p(!1)}},F=async e=>{e.preventDefault(),f(""),j(""),p(!0);try{let e=new FormData;e.append("username",w),e.append("educationalDetails",JSON.stringify(k)),x&&e.append("profile_picture",x);let a=await fetch("/api/auth/profile",{method:"PUT",body:e});if(!a.ok)throw Error("Failed to update profile");let l=await a.json();n(l.user),u(!1),v(null),l.user.profile_picture&&y(l.user.profile_picture),j("Profile updated successfully!"),setTimeout(()=>j(""),3e3)}catch(e){console.error("Save error:",e),f(e.message)}finally{p(!1)}};return o?(0,a.jsx)("div",{className:"loading",children:"Loading profile..."}):t?(0,a.jsxs)("div",{className:"profile-page",children:[(0,a.jsxs)("div",{className:"container",children:[(0,a.jsx)("h1",{className:"page-title",children:"My Profile"}),(0,a.jsxs)("div",{className:"profile-container",children:[(0,a.jsxs)("div",{className:"profile-header",children:[(0,a.jsx)("div",{className:"profile-avatar-section",children:(0,a.jsxs)("div",{className:"profile-avatar",onClick:()=>C(!0),title:"Click to view profile picture",children:[N||t.profile_picture?(0,a.jsx)("img",{src:N||t.profile_picture,alt:t.username,className:"profile-image",onError:e=>{e.target.style.display="none"}}):null,!N&&!t.profile_picture&&(0,a.jsx)("div",{className:"avatar-placeholder",children:t.username.charAt(0).toUpperCase()})]})}),(0,a.jsxs)("div",{className:"profile-info",children:[(0,a.jsx)("h2",{children:t.username}),(0,a.jsx)("p",{className:"profile-email",children:t.email}),(0,a.jsx)("span",{className:`auth-badge ${t.auth_provider}`,children:"google"===t.auth_provider?"ðŸ” Google Account":"ðŸ“§ Email Account"}),(0,a.jsxs)("p",{className:"profile-joined",children:["Member since ",new Date(t.created_at).toLocaleDateString("en-US",{year:"numeric",month:"long"})]}),(0,a.jsx)("button",{onClick:i,className:"btn btn-danger",style:{marginTop:"1rem",padding:"0.5rem 1rem",fontSize:"0.9rem"},children:"Logout"})]})]}),(0,a.jsxs)("div",{className:"profile-section",children:[(0,a.jsxs)("div",{className:"section-header",children:[(0,a.jsx)("h3",{children:"Educational Details"}),!d&&(0,a.jsx)("button",{onClick:()=>u(!0),className:"btn btn-primary",children:"Edit Details"})]}),h&&(0,a.jsx)("div",{className:"error",children:h}),g&&(0,a.jsx)("div",{className:"success",children:g}),d?(0,a.jsxs)("form",{onSubmit:F,className:"educational-form",children:[(0,a.jsxs)("div",{className:"form-group",style:{marginBottom:"1.5rem"},children:[(0,a.jsx)("label",{className:"form-label",children:"Username"}),(0,a.jsx)("input",{type:"text",className:"form-input",value:w,onChange:e=>P(e.target.value),required:!0,minLength:3})]}),(0,a.jsxs)("div",{className:"form-row",children:[(0,a.jsxs)("div",{className:"form-group",children:[(0,a.jsx)("label",{className:"form-label",children:"Current Level"}),(0,a.jsxs)("select",{className:"form-select",value:k.current_level,onChange:e=>U({...k,current_level:e.target.value}),children:[(0,a.jsx)("option",{value:"",children:"Select Level"}),(0,a.jsx)("option",{value:"High School",children:"High School"}),(0,a.jsx)("option",{value:"Undergraduate",children:"Undergraduate"}),(0,a.jsx)("option",{value:"Graduate",children:"Graduate"}),(0,a.jsx)("option",{value:"Professional",children:"Professional"}),(0,a.jsx)("option",{value:"Other",children:"Other"})]})]}),(0,a.jsxs)("div",{className:"form-group",children:[(0,a.jsx)("label",{className:"form-label",children:"Degree"}),(0,a.jsx)("input",{type:"text",className:"form-input",placeholder:"e.g., B.Tech, M.Sc",value:k.degree,onChange:e=>U({...k,degree:e.target.value})})]})]}),(0,a.jsxs)("div",{className:"form-group",children:[(0,a.jsx)("label",{className:"form-label",children:"Institution"}),(0,a.jsx)("input",{type:"text",className:"form-input",placeholder:"University/College name",value:k.institution,onChange:e=>U({...k,institution:e.target.value})})]}),(0,a.jsxs)("div",{className:"form-row",children:[(0,a.jsxs)("div",{className:"form-group",children:[(0,a.jsx)("label",{className:"form-label",children:"Field of Study"}),(0,a.jsx)("input",{type:"text",className:"form-input",placeholder:"e.g., Computer Science",value:k.field_of_study,onChange:e=>U({...k,field_of_study:e.target.value})})]}),(0,a.jsxs)("div",{className:"form-group",children:[(0,a.jsx)("label",{className:"form-label",children:"Graduation Year"}),(0,a.jsx)("input",{type:"number",className:"form-input",placeholder:"e.g., 2024",min:"1950",max:"2100",value:k.graduation_year,onChange:e=>U({...k,graduation_year:e.target.value})})]})]}),(0,a.jsxs)("div",{className:"form-actions",children:[(0,a.jsx)("button",{type:"button",onClick:()=>{u(!1),f(""),j(""),v(null),t&&(P(t.username||""),U({degree:t.degree||"",institution:t.institution||"",graduation_year:t.graduation_year||"",field_of_study:t.field_of_study||"",current_level:t.current_level||""}),t.profile_picture?y(t.profile_picture):y(null))},className:"btn btn-secondary",disabled:m,children:"Cancel"}),(0,a.jsx)("button",{type:"submit",className:"btn btn-primary",disabled:m,children:m?"Saving...":"Save Changes"})]})]}):(0,a.jsx)("div",{className:"educational-details-view",children:t.current_level||t.degree||t.institution?(0,a.jsxs)("div",{className:"details-grid",children:[t.current_level&&(0,a.jsxs)("div",{className:"detail-item",children:[(0,a.jsx)("span",{className:"detail-label",children:"Current Level:"}),(0,a.jsx)("span",{className:"detail-value",children:t.current_level})]}),t.degree&&(0,a.jsxs)("div",{className:"detail-item",children:[(0,a.jsx)("span",{className:"detail-label",children:"Degree:"}),(0,a.jsx)("span",{className:"detail-value",children:t.degree})]}),t.institution&&(0,a.jsxs)("div",{className:"detail-item",children:[(0,a.jsx)("span",{className:"detail-label",children:"Institution:"}),(0,a.jsx)("span",{className:"detail-value",children:t.institution})]}),t.field_of_study&&(0,a.jsxs)("div",{className:"detail-item",children:[(0,a.jsx)("span",{className:"detail-label",children:"Field of Study:"}),(0,a.jsx)("span",{className:"detail-value",children:t.field_of_study})]}),t.graduation_year&&(0,a.jsxs)("div",{className:"detail-item",children:[(0,a.jsx)("span",{className:"detail-label",children:"Graduation Year:"}),(0,a.jsx)("span",{className:"detail-value",children:t.graduation_year})]})]}):(0,a.jsx)("p",{className:"no-details",children:'No educational details added yet. Click "Edit Details" to add your information.'})})]})]})]}),S&&(0,a.jsx)("div",{className:"profile-image-modal-overlay",onClick:()=>C(!1),children:(0,a.jsxs)("div",{className:"profile-image-modal",onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("div",{className:"modal-header",children:[(0,a.jsx)("h3",{children:"Profile photo"}),(0,a.jsx)("button",{className:"close-btn",onClick:()=>C(!1),children:"âœ•"})]}),(0,a.jsx)("div",{className:"modal-body",children:N||t.profile_picture?(0,a.jsx)("img",{src:N||t.profile_picture,alt:t.username,className:"modal-image"}):(0,a.jsx)("div",{className:"modal-placeholder",children:t.username.charAt(0).toUpperCase()})}),(0,a.jsx)("div",{className:"modal-footer",children:(0,a.jsxs)("div",{className:"modal-actions",children:[(0,a.jsxs)("label",{htmlFor:"modal-image-upload",className:"modal-action-btn",children:[(0,a.jsx)("span",{className:"icon",children:"âœŽ"}),(0,a.jsx)("span",{className:"text",children:x?"Change Photo":"Update Photo"})]}),(0,a.jsx)("input",{id:"modal-image-upload",type:"file",accept:"image/jpeg,image/jpg,image/png,image/gif,image/webp",onChange:e=>{let a=e.target.files[0];if(a){if(!a.type.match("image.*"))return void f("Please select an image file");if(a.size>5242880)return void f("Image size must be less than 5MB");v(a);let e=new FileReader;e.onloadend=()=>{y(e.result)},e.readAsDataURL(a)}},style:{display:"none"}}),x&&(0,a.jsxs)("button",{className:"modal-action-btn save",onClick:T,disabled:m,children:[(0,a.jsx)("span",{className:"icon",children:"ðŸ’¾"}),(0,a.jsx)("span",{className:"text",children:m?"Saving...":"Save"})]}),(t.profile_picture||N)&&(0,a.jsxs)("button",{className:"modal-action-btn delete",onClick:E,disabled:_,children:[(0,a.jsx)("span",{className:"icon",children:"ðŸ—‘"}),(0,a.jsx)("span",{className:"text",children:"Delete"})]})]})})]})})]}):(0,a.jsx)("div",{className:"error",children:"User not found"})}e.s(["default",()=>i])}]);