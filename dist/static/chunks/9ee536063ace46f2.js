(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,53977,e=>{"use strict";var s=e.i(43476),t=e.i(71645),a=e.i(18566);function r(){let[e,r]=(0,t.useState)([]),[i,l]=(0,t.useState)(!0),[c,o]=(0,t.useState)("library"),[n,d]=(0,t.useState)(""),[u,m]=(0,t.useState)([]),[h,p]=(0,t.useState)(!1),[b,y]=(0,t.useState)(""),[j,x]=(0,t.useState)(!1),[v,g]=(0,t.useState)(""),[N,f]=(0,t.useState)(""),[w,S]=(0,t.useState)(""),[T,k]=(0,t.useState)(null),C=(0,a.useRouter)();(0,t.useEffect)(()=>{P()},[]);let P=async()=>{try{let e=await fetch("/api/courses"),s=(await e.json()).filter(e=>"YouTube Playlist"===e.course_type||"string"==typeof e.description&&e.description.includes("YouTube")||"string"==typeof e.title&&e.title.includes("YouTube"));r(s)}catch(e){console.error(e),f("Failed to load resources")}finally{l(!1)}},Y=async(e,s=null)=>{e&&e.preventDefault();let t=s||v;if(t){x(!0),f(""),S("");try{let e=await fetch("/api/courses",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({playlist_url:t,title:"",course_type:"YouTube Playlist"})}),a=await e.json();if(!e.ok)throw Error(a.error||"Failed to import YouTube content");S(`Successfully imported: ${a.title}`),s||g(""),P(),setTimeout(()=>S(""),3e3)}catch(e){console.error(e),f(e.message)}finally{x(!1)}}},$=async e=>{if(e.preventDefault(),n.trim()){p(!0),y(""),m([]);try{let e=await fetch(`/api/youtube/search?q=${encodeURIComponent(n)}`);if(!e.ok)throw Error("Failed to search");let s=await e.json();m(s)}catch(e){console.error(e),y("Failed to search YouTube. Please try again.")}finally{p(!1)}}},_=e=>{j||Y(null,"video"===e.type?`https://www.youtube.com/watch?v=${e.id}`:`https://www.youtube.com/playlist?list=${e.id}`)},R=e=>{k(e)},B=()=>{k(null)};return i?(0,s.jsx)("div",{className:"loading",children:"Loading..."}):(0,s.jsx)("div",{className:"youtube-page",children:(0,s.jsxs)("div",{className:"container",children:[(0,s.jsxs)("div",{className:"youtube-header",children:[(0,s.jsx)("h1",{children:"YouTube Resources"}),(0,s.jsx)("p",{children:"Browse, preview, and track YouTube learning content."})]}),(0,s.jsxs)("div",{className:"tab-nav",children:[(0,s.jsx)("button",{className:`tab-btn ${"library"===c?"active":""}`,onClick:()=>o("library"),children:"My Library"}),(0,s.jsx)("button",{className:`tab-btn ${"browse"===c?"active":""}`,onClick:()=>o("browse"),children:"Browse YouTube"})]}),N&&(0,s.jsx)("div",{className:"error-msg global-error",children:N}),w&&(0,s.jsx)("div",{className:"success-msg global-success",children:w}),"library"===c&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"import-section",children:[(0,s.jsx)("h3",{children:"Quick Import"}),(0,s.jsxs)("form",{onSubmit:Y,className:"import-form",children:[(0,s.jsx)("input",{type:"text",className:"form-input import-input",placeholder:"Paste YouTube Video or Playlist URL",value:v,onChange:e=>g(e.target.value)}),(0,s.jsx)("button",{type:"submit",className:"btn btn-primary import-btn",disabled:j||!v,children:j?"Importing...":"Import"})]})]}),(0,s.jsx)("div",{className:"resources-grid",children:e.length>0?e.map(e=>(0,s.jsxs)("div",{className:"resource-card",onClick:()=>C.push(`/courses/${e.id}`),children:[(0,s.jsxs)("div",{className:"resource-thumb",children:[(0,s.jsx)("img",{src:(e=>{if(e.playlist_url){let s=e.playlist_url.match(/(?:youtube\.com\/watch\?v=|youtu\.be\/|youtube\.com\/embed\/)([^&\n?#]+)/);if(s)return`https://img.youtube.com/vi/${s[1]}/mqdefault.jpg`}return"https://www.iconpacks.net/icons/2/free-youtube-logo-icon-2431-thumb.png"})(e),alt:e.title,onError:e=>e.target.src="https://www.iconpacks.net/icons/2/free-youtube-logo-icon-2431-thumb.png"}),(0,s.jsx)("span",{className:"resource-type-badge",children:"YouTube Playlist"===e.course_type?"Playlist":"Video"})]}),(0,s.jsxs)("div",{className:"resource-info",children:[(0,s.jsx)("h3",{children:e.title}),(0,s.jsxs)("div",{className:"resource-stats",children:[(0,s.jsxs)("span",{children:[e.total_lectures," items"]}),(0,s.jsxs)("span",{children:[e.completion_percentage,"% complete"]})]}),(0,s.jsx)("div",{className:"progress-bar-sm",children:(0,s.jsx)("div",{className:"progress-fill-sm",style:{width:`${e.completion_percentage}%`}})})]})]},e.id)):(0,s.jsx)("div",{className:"no-resources",children:(0,s.jsx)("p",{children:"No YouTube resources imported yet."})})})]}),"browse"===c&&(0,s.jsxs)("div",{className:"browse-section",children:[(0,s.jsxs)("form",{onSubmit:$,className:"search-form",children:[(0,s.jsx)("input",{type:"text",className:"form-input search-input",placeholder:"Search for topics (e.g., 'React Hooks', 'Python for Beginners')...",value:n,onChange:e=>d(e.target.value)}),(0,s.jsx)("button",{type:"submit",className:"btn btn-primary search-btn",disabled:h,children:h?"Searching...":"Search"})]}),b&&(0,s.jsx)("div",{className:"error-msg",children:b}),(0,s.jsxs)("div",{className:"search-results-grid",children:[u.map(e=>(0,s.jsxs)("div",{className:"search-card",children:[(0,s.jsxs)("div",{className:"search-thumb",onClick:()=>R(e),children:[(0,s.jsx)("img",{src:e.thumbnail,alt:e.title}),(0,s.jsx)("span",{className:"resource-type-badge",children:e.type}),(0,s.jsx)("div",{className:"play-overlay",children:"▶"})]}),(0,s.jsxs)("div",{className:"search-info",children:[(0,s.jsx)("h3",{dangerouslySetInnerHTML:{__html:e.title}}),(0,s.jsx)("p",{className:"channel-name",children:e.channelTitle}),(0,s.jsxs)("div",{className:"search-actions",children:[(0,s.jsx)("button",{className:"btn btn-sm btn-secondary preview-btn",onClick:()=>R(e),children:"Preview"}),(0,s.jsx)("button",{className:"btn btn-sm btn-primary add-btn",onClick:()=>_(e),disabled:j,children:j?"Adding...":"+ Add"})]})]})]},e.id)),0===u.length&&!h&&n&&!b&&(0,s.jsx)("div",{className:"no-results",children:"No results found."})]})]}),T&&(0,s.jsx)("div",{className:"video-modal-overlay",onClick:B,children:(0,s.jsxs)("div",{className:"video-modal-content",onClick:e=>e.stopPropagation(),children:[(0,s.jsx)("button",{className:"close-modal-btn",onClick:B,children:"×"}),(0,s.jsx)("div",{className:"video-frame",children:(0,s.jsx)("iframe",{src:"playlist"===T.type?`https://www.youtube.com/embed/videoseries?list=${T.id}&autoplay=1`:`https://www.youtube.com/embed/${T.id}?autoplay=1`,title:T.title,frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0})}),(0,s.jsxs)("div",{className:"modal-footer",children:[(0,s.jsx)("h3",{children:T.title}),(0,s.jsx)("button",{className:"btn btn-primary add-btn-modal",onClick:()=>{_(T),B()},children:"+ Add to Library"})]})]})})]})})}e.s(["default",()=>r])}]);