(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,53977,e=>{"use strict";var s=e.i(43476),t=e.i(71645),a=e.i(18566);function i(){let[e,i]=(0,t.useState)([]),[r,l]=(0,t.useState)(!0),[c,n]=(0,t.useState)("library"),[o,d]=(0,t.useState)(""),[u,h]=(0,t.useState)([]),[m,b]=(0,t.useState)(!1),[p,y]=(0,t.useState)(""),[j,x]=(0,t.useState)(!1),[g,v]=(0,t.useState)(""),[N,f]=(0,t.useState)(""),[w,S]=(0,t.useState)(""),[k,T]=(0,t.useState)([]),[C,P]=(0,t.useState)(!1),[Y,_]=(0,t.useState)(null),$=(0,a.useRouter)();(0,t.useEffect)(()=>{F(),R()},[]);let R=async()=>{P(!0);try{let e=await fetch("/api/youtube/suggestions");if(e.ok){let s=await e.json();T(s)}}catch(e){console.error("Failed to fetch suggestions:",e)}finally{P(!1)}},F=async()=>{try{let e=await fetch("/api/courses"),s=(await e.json()).filter(e=>"YouTube Playlist"===e.course_type||"string"==typeof e.description&&e.description.includes("YouTube")||"string"==typeof e.title&&e.title.includes("YouTube"));i(s)}catch(e){console.error(e),f("Failed to load resources")}finally{l(!1)}},A=async(e,s=null)=>{e&&e.preventDefault();let t=s||g;if(t){x(!0),f(""),S("");try{let e=await fetch("/api/courses",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({playlist_url:t,title:"",course_type:"YouTube Playlist"})}),a=await e.json();if(!e.ok)throw Error(a.error||"Failed to import YouTube content");S(`Successfully imported: ${a.title}`),s||v(""),F(),setTimeout(()=>S(""),3e3)}catch(e){console.error(e),f(e.message)}finally{x(!1)}}},B=async e=>{if(e.preventDefault(),o.trim()){b(!0),y(""),h([]);try{let e=await fetch(`/api/youtube/search?q=${encodeURIComponent(o)}`);if(!e.ok)throw Error("Failed to search");let s=await e.json();h(s)}catch(e){console.error(e),y("Failed to search YouTube. Please try again.")}finally{b(!1)}}},I=e=>{j||A(null,"video"===e.type?`https://www.youtube.com/watch?v=${e.id}`:`https://www.youtube.com/playlist?list=${e.id}`)},L=e=>{_(e)},E=()=>{_(null)};return r?(0,s.jsx)("div",{className:"loading",children:"Loading..."}):(0,s.jsx)("div",{className:"youtube-page",children:(0,s.jsxs)("div",{className:"container",children:[(0,s.jsxs)("div",{className:"youtube-header",children:[(0,s.jsx)("h1",{children:"YouTube Resources"}),(0,s.jsx)("p",{children:"Browse, preview, and track YouTube learning content."})]}),(0,s.jsxs)("div",{className:"tab-nav",children:[(0,s.jsx)("button",{className:`tab-btn ${"library"===c?"active":""}`,onClick:()=>n("library"),children:"My Library"}),(0,s.jsx)("button",{className:`tab-btn ${"browse"===c?"active":""}`,onClick:()=>n("browse"),children:"Browse YouTube"}),(0,s.jsx)("button",{className:`tab-btn ${"suggestions"===c?"active":""}`,onClick:()=>n("suggestions"),children:"Suggested for You"})]}),N&&(0,s.jsx)("div",{className:"error-msg global-error",children:N}),w&&(0,s.jsx)("div",{className:"success-msg global-success",children:w}),"library"===c&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"import-section",children:[(0,s.jsx)("h3",{children:"Quick Import"}),(0,s.jsxs)("form",{onSubmit:A,className:"import-form",children:[(0,s.jsx)("input",{type:"text",className:"form-input import-input",placeholder:"Paste YouTube Video or Playlist URL",value:g,onChange:e=>v(e.target.value)}),(0,s.jsx)("button",{type:"submit",className:"btn btn-primary import-btn",disabled:j||!g,children:j?"Importing...":"Import"})]})]}),(0,s.jsx)("div",{className:"resources-grid",children:e.length>0?e.map(e=>(0,s.jsxs)("div",{className:"resource-card",onClick:()=>$.push(`/courses/${e.id}`),children:[(0,s.jsxs)("div",{className:"resource-thumb",children:[(0,s.jsx)("img",{src:(e=>{if(e.playlist_url){let s=e.playlist_url.match(/(?:youtube\.com\/watch\?v=|youtu\.be\/|youtube\.com\/embed\/)([^&\n?#]+)/);if(s)return`https://img.youtube.com/vi/${s[1]}/mqdefault.jpg`}return"https://www.iconpacks.net/icons/2/free-youtube-logo-icon-2431-thumb.png"})(e),alt:e.title,onError:e=>e.target.src="https://www.iconpacks.net/icons/2/free-youtube-logo-icon-2431-thumb.png"}),(0,s.jsx)("span",{className:"resource-type-badge",children:"YouTube Playlist"===e.course_type?"Playlist":"Video"})]}),(0,s.jsxs)("div",{className:"resource-info",children:[(0,s.jsx)("h3",{children:e.title}),(0,s.jsxs)("div",{className:"resource-stats",children:[(0,s.jsxs)("span",{children:[e.total_lectures," items"]}),(0,s.jsxs)("span",{children:[e.completion_percentage,"% complete"]})]}),(0,s.jsx)("div",{className:"progress-bar-sm",children:(0,s.jsx)("div",{className:"progress-fill-sm",style:{width:`${e.completion_percentage}%`}})})]})]},e.id)):(0,s.jsx)("div",{className:"no-resources",children:(0,s.jsx)("p",{children:"No YouTube resources imported yet."})})})]}),"suggestions"===c&&(0,s.jsxs)("div",{className:"suggestions-section",children:[(0,s.jsxs)("div",{className:"section-header-row",children:[(0,s.jsx)("h3",{children:"Recommended for your Branch"}),(0,s.jsx)("button",{className:"btn btn-sm btn-secondary",onClick:R,disabled:C,children:C?"Refreshing...":"Refresh"})]}),C&&0===k.length?(0,s.jsx)("div",{className:"loading",children:"Finding best resources for your background..."}):(0,s.jsxs)("div",{className:"search-results-grid",children:[k.map(e=>(0,s.jsxs)("div",{className:"search-card",children:[(0,s.jsxs)("div",{className:"search-thumb",onClick:()=>L(e),children:[(0,s.jsx)("img",{src:e.thumbnail,alt:e.title}),(0,s.jsx)("span",{className:"resource-type-badge",children:e.type}),(0,s.jsx)("div",{className:"play-overlay",children:"▶"})]}),(0,s.jsxs)("div",{className:"search-info",children:[(0,s.jsx)("h3",{dangerouslySetInnerHTML:{__html:e.title}}),(0,s.jsx)("p",{className:"channel-name",children:e.channelTitle}),(0,s.jsxs)("div",{className:"search-actions",children:[(0,s.jsx)("button",{className:"btn btn-sm btn-secondary preview-btn",onClick:()=>L(e),children:"Preview"}),(0,s.jsx)("button",{className:"btn btn-sm btn-primary add-btn",onClick:()=>I(e),disabled:j,children:j?"Adding...":"+ Add"})]})]})]},e.id)),0===k.length&&!C&&(0,s.jsx)("div",{className:"no-results",children:"No specific suggestions found. Try updating your branch in the Profile."})]})]}),"browse"===c&&(0,s.jsxs)("div",{className:"browse-section",children:[(0,s.jsxs)("form",{onSubmit:B,className:"search-form",children:[(0,s.jsx)("input",{type:"text",className:"form-input search-input",placeholder:"Search for topics (e.g., 'React Hooks', 'Python for Beginners')...",value:o,onChange:e=>d(e.target.value)}),(0,s.jsx)("button",{type:"submit",className:"btn btn-primary search-btn",disabled:m,children:m?"Searching...":"Search"})]}),p&&(0,s.jsx)("div",{className:"error-msg",children:p}),(0,s.jsxs)("div",{className:"search-results-grid",children:[u.map(e=>(0,s.jsxs)("div",{className:"search-card",children:[(0,s.jsxs)("div",{className:"search-thumb",onClick:()=>L(e),children:[(0,s.jsx)("img",{src:e.thumbnail,alt:e.title}),(0,s.jsx)("span",{className:"resource-type-badge",children:e.type}),(0,s.jsx)("div",{className:"play-overlay",children:"▶"})]}),(0,s.jsxs)("div",{className:"search-info",children:[(0,s.jsx)("h3",{dangerouslySetInnerHTML:{__html:e.title}}),(0,s.jsx)("p",{className:"channel-name",children:e.channelTitle}),(0,s.jsxs)("div",{className:"search-actions",children:[(0,s.jsx)("button",{className:"btn btn-sm btn-secondary preview-btn",onClick:()=>L(e),children:"Preview"}),(0,s.jsx)("button",{className:"btn btn-sm btn-primary add-btn",onClick:()=>I(e),disabled:j,children:j?"Adding...":"+ Add"})]})]})]},e.id)),0===u.length&&!m&&o&&!p&&(0,s.jsx)("div",{className:"no-results",children:"No results found."})]})]}),Y&&(0,s.jsx)("div",{className:"video-modal-overlay",onClick:E,children:(0,s.jsxs)("div",{className:"video-modal-content",onClick:e=>e.stopPropagation(),children:[(0,s.jsx)("button",{className:"close-modal-btn",onClick:E,children:"×"}),(0,s.jsx)("div",{className:"video-frame",children:(0,s.jsx)("iframe",{src:"playlist"===Y.type?`https://www.youtube.com/embed/videoseries?list=${Y.id}&autoplay=1`:`https://www.youtube.com/embed/${Y.id}?autoplay=1`,title:Y.title,frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0})}),(0,s.jsxs)("div",{className:"modal-footer",children:[(0,s.jsx)("h3",{children:Y.title}),(0,s.jsx)("button",{className:"btn btn-primary add-btn-modal",onClick:()=>{I(Y),E()},children:"+ Add to Library"})]})]})})]})})}e.s(["default",()=>i])}]);