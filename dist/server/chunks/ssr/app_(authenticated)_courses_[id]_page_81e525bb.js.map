{"version":3,"sources":["../../../../app/%28authenticated%29/courses/%5Bid%5D/page.js"],"sourcesContent":["'use client';\n\nimport { useState, useEffect } from 'react';\nimport Link from 'next/link';\nimport { useParams } from 'next/navigation';\nimport './course-detail.css';\n\nexport default function CourseDetailPage() {\n    const { id } = useParams();\n    const [course, setCourse] = useState(null);\n    const [lectures, setLectures] = useState([]);\n    const [loading, setLoading] = useState(true);\n    const [error, setError] = useState('');\n    const [showForm, setShowForm] = useState(false);\n    const [formData, setFormData] = useState({\n        title: '',\n        youtube_url: '',\n        difficulty: 'Medium',\n        order_index: 0\n    });\n\n    useEffect(() => {\n        fetchCourse();\n    }, [id]);\n\n    const fetchCourse = async () => {\n        try {\n            const response = await fetch(`/api/courses/${id}`);\n            if (!response.ok) throw new Error('Failed to fetch course');\n            const data = await response.json();\n            setCourse(data);\n            setLectures(data.lectures || []);\n        } catch (err) {\n            setError('Failed to load course');\n            console.error(err);\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    const formatDuration = (seconds) => {\n        if (!seconds) return '0m';\n        const hours = Math.floor(seconds / 3600);\n        const minutes = Math.floor((seconds % 3600) / 60);\n\n        if (hours > 0) {\n            return `${hours}h ${minutes}m`;\n        } else {\n            return `${minutes}m`;\n        }\n    };\n\n    const formatHours = (hours) => {\n        if (!hours) return '0h';\n        const h = Math.floor(hours);\n        const m = Math.floor((hours - h) * 60);\n        if (h > 0 && m > 0) {\n            return `${h}h ${m}m`;\n        } else if (h > 0) {\n            return `${h}h`;\n        } else {\n            return `${m}m`;\n        }\n    };\n\n    const handleSubmit = async (e) => {\n        e.preventDefault();\n        try {\n            const response = await fetch('/api/lectures', {\n                method: 'POST',\n                headers: { 'Content-Type': 'application/json' },\n                body: JSON.stringify({\n                    ...formData,\n                    course_id: id\n                })\n            });\n\n            const data = await response.json();\n            if (!response.ok) throw new Error(data.error || 'Failed to create lecture');\n\n            setFormData({\n                title: '',\n                youtube_url: '',\n                difficulty: 'Medium',\n                order_index: lectures.length\n            });\n            setShowForm(false);\n            fetchCourse();\n        } catch (err) {\n            setError(err.message);\n        }\n    };\n\n    const handleDelete = async (lectureId) => {\n        if (!window.confirm('Are you sure you want to delete this lecture?')) {\n            return;\n        }\n        try {\n            const response = await fetch(`/api/lectures/${lectureId}`, {\n                method: 'DELETE'\n            });\n            if (!response.ok) throw new Error('Failed to delete lecture');\n\n            fetchCourse();\n        } catch (err) {\n            setError(err.message);\n        }\n    };\n\n    const toggleComplete = async (lecture) => {\n        try {\n            const response = await fetch(`/api/lectures/${lecture.id}`, {\n                method: 'PUT',\n                headers: { 'Content-Type': 'application/json' },\n                body: JSON.stringify({\n                    is_completed: !lecture.is_completed\n                })\n            });\n            if (!response.ok) throw new Error('Failed to update lecture');\n\n            fetchCourse();\n        } catch (err) {\n            setError(err.message);\n        }\n    };\n\n    if (loading) {\n        return <div className=\"loading\">Loading course...</div>;\n    }\n\n    if (!course) {\n        return <div className=\"error\">Course not found</div>;\n    }\n\n    return (\n        <div className=\"course-detail\">\n            <div className=\"container\">\n                <Link href=\"/courses\" className=\"back-link\">‚Üê Back to Courses</Link>\n\n                <div className=\"course-header\">\n                    <h1 className=\"page-title\">{course.title}</h1>\n                    <button\n                        onClick={() => setShowForm(!showForm)}\n                        className=\"btn btn-primary\"\n                    >\n                        {showForm ? 'Cancel' : '+ Add Lecture'}\n                    </button>\n                </div>\n\n                <p className=\"course-description\">{course.description || 'No description'}</p>\n\n                {/* Course hours info */}\n                {course.total_hours > 0 && (\n                    <div className=\"course-hours-info\">\n                        <div className=\"hours-stat\">\n                            <span className=\"hours-label\">Total Duration:</span>\n                            <span className=\"hours-value\">{formatHours(course.total_hours)}</span>\n                        </div>\n                        <div className=\"hours-stat\">\n                            <span className=\"hours-label\">Completed:</span>\n                            <span className=\"hours-value completed\">{formatHours(course.completed_hours)}</span>\n                        </div>\n                        <div className=\"hours-progress-bar\">\n                            <div\n                                className=\"hours-progress-fill\"\n                                style={{\n                                    width: `${course.total_hours > 0 ? (course.completed_hours / course.total_hours) * 100 : 0}%`\n                                }}\n                            ></div>\n                        </div>\n                    </div>\n                )}\n\n                {error && <div className=\"error\">{error}</div>}\n\n                {showForm && (\n                    <div className=\"card\">\n                        <h2>Add New Lecture</h2>\n                        <form onSubmit={handleSubmit}>\n                            <div className=\"form-group\">\n                                <label className=\"form-label\">Lecture Title *</label>\n                                <input\n                                    type=\"text\"\n                                    className=\"form-input\"\n                                    value={formData.title}\n                                    onChange={(e) =>\n                                        setFormData({ ...formData, title: e.target.value })\n                                    }\n                                    required\n                                />\n                            </div>\n\n                            <div className=\"form-group\">\n                                <label className=\"form-label\">YouTube URL</label>\n                                <input\n                                    type=\"text\"\n                                    className=\"form-input\"\n                                    value={formData.youtube_url}\n                                    onChange={(e) =>\n                                        setFormData({ ...formData, youtube_url: e.target.value })\n                                    }\n                                    placeholder=\"https://www.youtube.com/watch?v=...\"\n                                />\n                            </div>\n\n                            <div className=\"form-group\">\n                                <label className=\"form-label\">Difficulty</label>\n                                <select\n                                    className=\"form-select\"\n                                    value={formData.difficulty}\n                                    onChange={(e) =>\n                                        setFormData({ ...formData, difficulty: e.target.value })\n                                    }\n                                >\n                                    <option value=\"Easy\">Easy</option>\n                                    <option value=\"Medium\">Medium</option>\n                                    <option value=\"Hard\">Hard</option>\n                                </select>\n                            </div>\n\n                            <button type=\"submit\" className=\"btn btn-primary\">\n                                Add Lecture\n                            </button>\n                        </form>\n                    </div>\n                )}\n\n                <div className=\"lectures-section\">\n                    <h2>Lectures ({lectures.length})</h2>\n                    {lectures.length === 0 ? (\n                        <div className=\"card\">\n                            <p className=\"no-data\">No lectures yet. Add your first lecture!</p>\n                        </div>\n                    ) : (\n                        <div className=\"lectures-list\">\n                            {lectures.map((lecture, index) => (\n                                <div\n                                    key={lecture.id}\n                                    className={`lecture-item ${lecture.is_completed ? 'completed' : ''}`}\n                                >\n                                    <div className=\"lecture-number\">{index + 1}</div>\n                                    <div className=\"lecture-content\">\n                                        <div className=\"lecture-header\">\n                                            <h3>{lecture.title}</h3>\n                                            <div className=\"lecture-actions\">\n                                                <span className={`difficulty-badge ${lecture.difficulty.toLowerCase()}`}>\n                                                    {lecture.difficulty}\n                                                </span>\n                                                <button\n                                                    onClick={() => toggleComplete(lecture)}\n                                                    className={`btn-complete ${lecture.is_completed ? 'completed' : ''}`}\n                                                >\n                                                    {lecture.is_completed ? '‚úì Completed' : 'Mark Complete'}\n                                                </button>\n                                                <button\n                                                    onClick={() => handleDelete(lecture.id)}\n                                                    className=\"btn-delete-small\"\n                                                >\n                                                    Delete\n                                                </button>\n                                            </div>\n                                        </div>\n                                        {lecture.youtube_url && (\n                                            <p className=\"lecture-video\">\n                                                üìπ Video: {lecture.youtube_url}\n                                            </p>\n                                        )}\n                                        {lecture.duration_seconds > 0 && (\n                                            <p className=\"lecture-duration\">\n                                                ‚è±Ô∏è Duration: {formatDuration(lecture.duration_seconds)}\n                                            </p>\n                                        )}\n                                        <Link\n                                            href={`/lectures/${lecture.id}`}\n                                            className=\"btn btn-primary btn-sm\"\n                                        >\n                                            Open Lecture\n                                        </Link>\n                                    </div>\n                                </div>\n                            ))}\n                        </div>\n                    )}\n                </div>\n            </div>\n        </div>\n    );\n}\n"],"names":[],"mappings":"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"}