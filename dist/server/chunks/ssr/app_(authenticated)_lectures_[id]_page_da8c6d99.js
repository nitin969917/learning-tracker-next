module.exports=[54551,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(38246),e=a.i(50944);let f=({lectureId:a})=>{let[d,e]=(0,c.useState)(""),[f,g]=(0,c.useState)(!0),[h,i]=(0,c.useState)(!1),[j,k]=(0,c.useState)(null);(0,c.useEffect)(()=>{l()},[a]);let l=async()=>{try{let b=await fetch(`/api/notes/lecture/${a}`);if(!b.ok)throw Error("Failed to fetch notes");let c=await b.json();e(c.content||"")}catch(a){console.error("Failed to load notes")}finally{g(!1)}},m=async()=>{i(!0);try{if(!(await fetch(`/api/notes/lecture/${a}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:d})})).ok)throw Error("Failed to save notes");k(new Date)}catch(a){alert("Failed to save notes")}finally{i(!1)}};return((0,c.useEffect)(()=>{if(!f){let a;return a=setTimeout(()=>{d.trim()&&m()},2e3),()=>clearTimeout(a)}},[d,f]),f)?(0,b.jsx)("div",{className:"loading",children:"Loading notes..."}):(0,b.jsxs)("div",{className:"notes-editor",children:[(0,b.jsxs)("div",{className:"notes-header",children:[(0,b.jsx)("h2",{children:"My Notes"}),(0,b.jsxs)("div",{className:"notes-actions",children:[j&&(0,b.jsxs)("span",{className:"last-saved",children:["Saved ",j.toLocaleTimeString()]}),(0,b.jsx)("button",{onClick:m,className:"btn btn-primary",disabled:h,children:h?"Saving...":"Save Notes"})]})]}),(0,b.jsx)("textarea",{className:"notes-textarea",value:d,onChange:a=>e(a.target.value),placeholder:"Write your notes here... You can use markdown formatting.",rows:20}),(0,b.jsx)("p",{className:"notes-hint",children:'ðŸ’¡ Your notes are automatically saved. You can also click "Save Notes" to save manually.'})]})};var g=a.i(10850);let h=({lectureId:a})=>{let[d,e]=(0,c.useState)([]),[f,h]=(0,c.useState)(""),[i,j]=(0,c.useState)(null),[k,l]=(0,c.useState)(""),[m,n]=(0,c.useState)(!0),{user:o}=(0,g.useAuth)();(0,c.useEffect)(()=>{p()},[a]);let p=async()=>{try{let b=await fetch(`/api/discussions/lecture/${a}`);if(!b.ok)throw Error("Failed to load discussions");let c=await b.json();e(c)}catch(a){console.error("Failed to load discussions")}finally{n(!1)}},q=async b=>{if(b.preventDefault(),f.trim())try{if(!(await fetch("/api/discussions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({lecture_id:a,content:f})})).ok)throw Error("Failed to post comment");h(""),p()}catch(a){alert("Failed to post comment")}},r=async b=>{if(k.trim())try{if(!(await fetch("/api/discussions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({lecture_id:a,parent_id:b,content:k})})).ok)throw Error("Failed to post reply");l(""),j(null),p()}catch(a){alert("Failed to post reply")}},s=async a=>{if(window.confirm("Are you sure you want to delete this comment?"))try{if(!(await fetch(`/api/discussions/${a}`,{method:"DELETE"})).ok)throw Error("Failed to delete comment");p()}catch(a){alert("Failed to delete comment")}};return m?(0,b.jsx)("div",{className:"loading",children:"Loading discussions..."}):(0,b.jsxs)("div",{className:"discussion-thread",children:[(0,b.jsx)("h2",{children:"Discussion"}),(0,b.jsx)("p",{className:"discussion-subtitle",children:"Ask questions, share insights, and help your peers learn!"}),(0,b.jsxs)("form",{onSubmit:q,className:"comment-form",children:[(0,b.jsx)("textarea",{className:"form-textarea",value:f,onChange:a=>h(a.target.value),placeholder:"Write a comment...",rows:3}),(0,b.jsx)("button",{type:"submit",className:"btn btn-primary",children:"Post Comment"})]}),(0,b.jsx)("div",{className:"comments-list",children:0===d.length?(0,b.jsx)("p",{className:"no-comments",children:"No comments yet. Be the first to comment!"}):d.map(a=>(0,b.jsxs)("div",{className:"comment-item",children:[(0,b.jsxs)("div",{className:"comment-header",children:[(0,b.jsxs)("div",{className:"comment-author",children:[(0,b.jsx)("strong",{children:a.username}),(0,b.jsx)("span",{className:"comment-date",children:new Date(a.created_at).toLocaleString()})]}),a.user_id===o?.id&&(0,b.jsx)("button",{onClick:()=>s(a.id),className:"btn-delete-comment",children:"Delete"})]}),(0,b.jsx)("div",{className:"comment-content",children:a.content}),(0,b.jsx)("button",{onClick:()=>j(i===a.id?null:a.id),className:"btn-reply",children:i===a.id?"Cancel":"Reply"}),i===a.id&&(0,b.jsxs)("div",{className:"reply-form",children:[(0,b.jsx)("textarea",{className:"form-textarea",value:k,onChange:a=>l(a.target.value),placeholder:"Write a reply...",rows:2}),(0,b.jsx)("button",{onClick:()=>r(a.id),className:"btn btn-primary btn-sm",children:"Post Reply"})]}),a.replies&&a.replies.length>0&&(0,b.jsx)("div",{className:"replies-list",children:a.replies.map(a=>(0,b.jsxs)("div",{className:"reply-item",children:[(0,b.jsxs)("div",{className:"reply-header",children:[(0,b.jsx)("strong",{children:a.username}),(0,b.jsx)("span",{className:"reply-date",children:new Date(a.created_at).toLocaleString()}),a.user_id===o?.id&&(0,b.jsx)("button",{onClick:()=>s(a.id),className:"btn-delete-comment",children:"Delete"})]}),(0,b.jsx)("div",{className:"reply-content",children:a.content})]},a.id))})]},a.id))})]})};function i(){let{id:a}=(0,e.useParams)();(0,e.useRouter)();let[g,i]=(0,c.useState)(null),[j,k]=(0,c.useState)(!0),[l,m]=(0,c.useState)(""),[n,o]=(0,c.useState)(null),[p,q]=(0,c.useState)("video"),[r,s]=(0,c.useState)(null);(0,c.useRef)(null),(0,c.useEffect)(()=>{v(),w()},[a]),(0,c.useEffect)(()=>{if(window.YT)window.YT&&window.YT.Player&&t();else{let a=document.createElement("script");a.src="https://www.youtube.com/iframe_api";let b=document.getElementsByTagName("script")[0];b&&b.parentNode?b.parentNode.insertBefore(a,b):document.body.appendChild(a),window.onYouTubeIframeAPIReady=()=>{t()}}return()=>{r&&r.destroy}},[g?.youtube_video_id]);let t=()=>{!g?.youtube_video_id||document.getElementById("youtube-player")&&setTimeout(()=>{if(window.YT&&window.YT.Player)try{new window.YT.Player("youtube-player",{videoId:g.youtube_video_id,events:{onStateChange:a=>{a.data===window.YT.PlayerState.ENDED&&u()},onReady:a=>{s(a.target)}}})}catch(a){console.error("Failed to initialize YouTube player:",a)}},500)},u=async()=>{if(!g?.is_completed)try{if(!(await fetch(`/api/lectures/${a}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({is_completed:!0})})).ok)throw Error("Failed to auto-complete lecture");v();let b=document.createElement("div");b.className="auto-complete-notification",b.textContent="âœ“ Video completed! Marked as done.",document.body.appendChild(b),setTimeout(()=>{b.parentNode&&b.parentNode.removeChild(b)},3e3)}catch(a){console.error("Failed to auto-complete lecture:",a)}},v=async()=>{try{let b=await fetch(`/api/lectures/${a}`);if(!b.ok)throw Error("Failed to fetch lecture");let c=await b.json();i(c)}catch(a){m("Failed to load lecture"),console.error(a)}finally{k(!1)}},w=async()=>{try{let b=await fetch(`/api/revisions/lecture/${a}`);if(b.ok){let a=await b.json();o(a)}}catch(a){console.error("Failed to load revision data")}},x=async()=>{try{if(!(await fetch(`/api/lectures/${a}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({is_completed:!g.is_completed})})).ok)throw Error("Failed to update lecture");v()}catch(a){m(a.message)}},y=async b=>{try{if(!(await fetch(`/api/lectures/${a}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({difficulty:b})})).ok)throw Error("Failed to update difficulty");v()}catch(a){m(a.message)}},z=async()=>{try{let b=await fetch(`/api/revisions/lecture/${a}`,{method:"POST"});if(!b.ok)throw Error("Failed to mark revision");let c=await b.json();o(c)}catch(a){m(a.message)}};if(j)return(0,b.jsx)("div",{className:"loading",children:"Loading lecture..."});if(!g)return(0,b.jsx)("div",{className:"error",children:"Lecture not found"});let A=g.youtube_video_id,B=A?`https://www.youtube.com/embed/${A}`:null;return(0,b.jsx)("div",{className:"lecture-detail",children:(0,b.jsxs)("div",{className:"container",children:[(0,b.jsx)(d.default,{href:`/courses/${g.course_id}`,className:"back-link",children:"â† Back to Course"}),(0,b.jsxs)("div",{className:"lecture-header-card",children:[(0,b.jsxs)("div",{className:"lecture-title-section",children:[(0,b.jsx)("h1",{className:"lecture-title",children:g.title}),(0,b.jsxs)("div",{className:"lecture-meta",children:[(0,b.jsx)("span",{className:`difficulty-badge ${g.difficulty?.toLowerCase()||"medium"}`,children:g.difficulty||"Medium"}),g.is_completed&&(0,b.jsx)("span",{className:"completed-badge",children:"âœ“ Completed"}),n&&n.revision_count>0&&(0,b.jsxs)("span",{className:"revision-badge",children:["ðŸ”„ Revised ",n.revision_count," time(s)"]})]})]}),(0,b.jsxs)("div",{className:"lecture-actions",children:[(0,b.jsx)("button",{onClick:x,className:`btn ${g.is_completed?"btn-secondary":"btn-success"}`,children:g.is_completed?"Mark Incomplete":"Mark Complete"}),(0,b.jsx)("button",{onClick:z,className:"btn btn-primary",children:"Mark as Revised"}),(0,b.jsxs)("select",{value:g.difficulty||"Medium",onChange:a=>y(a.target.value),className:"form-select difficulty-select",children:[(0,b.jsx)("option",{value:"Easy",children:"Easy"}),(0,b.jsx)("option",{value:"Medium",children:"Medium"}),(0,b.jsx)("option",{value:"Hard",children:"Hard"})]})]})]}),l&&(0,b.jsx)("div",{className:"error",children:l}),(0,b.jsxs)("div",{className:"tabs",children:[(0,b.jsx)("button",{className:`tab ${"video"===p?"active":""}`,onClick:()=>q("video"),children:"ðŸ“¹ Video"}),(0,b.jsx)("button",{className:`tab ${"notes"===p?"active":""}`,onClick:()=>q("notes"),children:"ðŸ“ Notes"}),(0,b.jsx)("button",{className:`tab ${"discussion"===p?"active":""}`,onClick:()=>q("discussion"),children:"ðŸ’¬ Discussion"})]}),(0,b.jsxs)("div",{className:"tab-content",children:["video"===p&&(0,b.jsx)("div",{className:"card",children:B?(0,b.jsxs)("div",{className:"video-container",children:[(0,b.jsx)("div",{id:"youtube-player"}),g.duration_seconds>0&&(0,b.jsxs)("p",{className:"video-duration",children:["Duration: ",(a=>{if(!a)return"Unknown";let b=Math.floor(a/3600),c=Math.floor(a%3600/60),d=a%60;return b>0?`${b}h ${c}m ${d}s`:c>0?`${c}m ${d}s`:`${d}s`})(g.duration_seconds)]})]}):(0,b.jsxs)("div",{className:"no-video",children:[(0,b.jsx)("p",{children:"No video URL provided for this lecture."}),g.youtube_url&&(0,b.jsx)("a",{href:g.youtube_url,target:"_blank",rel:"noopener noreferrer",className:"btn btn-primary",children:"Open YouTube Link"})]})}),"notes"===p&&(0,b.jsx)("div",{className:"card",children:(0,b.jsx)(f,{lectureId:a})}),"discussion"===p&&(0,b.jsx)("div",{className:"card",children:(0,b.jsx)(h,{lectureId:a})})]})]})})}a.s(["default",()=>i],54551)}];

//# sourceMappingURL=app_%28authenticated%29_lectures_%5Bid%5D_page_da8c6d99.js.map