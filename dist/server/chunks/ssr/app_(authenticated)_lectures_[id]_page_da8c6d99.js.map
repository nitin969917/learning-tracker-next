{"version":3,"sources":["../../../../app/%28authenticated%29/lectures/%5Bid%5D/page.js","../../../../components/NotesEditor.js","../../../../components/DiscussionThread.js"],"sourcesContent":["'use client';\n\nimport { useState, useEffect, useRef } from 'react';\nimport Link from 'next/link';\nimport { useParams, useRouter } from 'next/navigation';\nimport NotesEditor from '@/components/NotesEditor';\nimport DiscussionThread from '@/components/DiscussionThread';\nimport './lecture-detail.css';\n\nexport default function LectureDetailPage() {\n    const { id } = useParams();\n    const router = useRouter();\n    const [lecture, setLecture] = useState(null);\n    const [loading, setLoading] = useState(true);\n    const [error, setError] = useState('');\n    const [revision, setRevision] = useState(null);\n    const [activeTab, setActiveTab] = useState('video');\n    const [player, setPlayer] = useState(null);\n    const playerRef = useRef(null);\n\n    useEffect(() => {\n        fetchLecture();\n        fetchRevision();\n    }, [id]);\n\n    useEffect(() => {\n        // Load YouTube IFrame API if not already loaded\n        if (!window.YT) {\n            const tag = document.createElement('script');\n            tag.src = 'https://www.youtube.com/iframe_api';\n            const firstScriptTag = document.getElementsByTagName('script')[0];\n            if (firstScriptTag && firstScriptTag.parentNode) {\n                firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);\n            } else {\n                document.body.appendChild(tag);\n            }\n\n            window.onYouTubeIframeAPIReady = () => {\n                initializePlayer();\n            };\n        } else if (window.YT && window.YT.Player) {\n            initializePlayer();\n        }\n\n        return () => {\n            if (player && player.destroy) {\n                // player.destroy(); // caused issues in some react versions, keeping safe\n            }\n        };\n    }, [lecture?.youtube_video_id]); // Re-run if video ID changes\n\n    const initializePlayer = () => {\n        if (!lecture?.youtube_video_id) return;\n\n        // Check if element exists\n        const container = document.getElementById('youtube-player');\n        if (!container) return;\n\n        // Use a timeout to ensure DOM is ready and avoid race conditions\n        setTimeout(() => {\n            if (!window.YT || !window.YT.Player) return;\n\n            try {\n                // If player already exists, destroy it first? Or just reuse?\n                // Simple approach: create new one.\n                const ytPlayer = new window.YT.Player('youtube-player', {\n                    videoId: lecture.youtube_video_id,\n                    events: {\n                        onStateChange: (event) => {\n                            // State 0 = ENDED\n                            if (event.data === window.YT.PlayerState.ENDED) {\n                                // Check updated completion status reference or assume if it was playing it might need completion\n                                // We can use a ref for lecture state if needed, but for now simple check\n                                handleAutoComplete();\n                            }\n                        },\n                        onReady: (event) => {\n                            setPlayer(event.target);\n                        }\n                    }\n                });\n            } catch (err) {\n                console.error('Failed to initialize YouTube player:', err);\n            }\n        }, 500);\n    };\n\n    const handleAutoComplete = async () => {\n        // Fetch latest state to be sure? Or just optimistically update?\n        // Check if already completed to avoid duplicate calls\n        if (lecture?.is_completed) return;\n\n        try {\n            const response = await fetch(`/api/lectures/${id}`, {\n                method: 'PUT',\n                headers: { 'Content-Type': 'application/json' },\n                body: JSON.stringify({ is_completed: true })\n            });\n\n            if (!response.ok) throw new Error('Failed to auto-complete lecture');\n\n            fetchLecture();\n\n            // Show notification\n            const notification = document.createElement('div');\n            notification.className = 'auto-complete-notification';\n            notification.textContent = '‚úì Video completed! Marked as done.';\n            document.body.appendChild(notification);\n\n            setTimeout(() => {\n                if (notification.parentNode) notification.parentNode.removeChild(notification);\n            }, 3000);\n        } catch (err) {\n            console.error('Failed to auto-complete lecture:', err);\n        }\n    };\n\n    const fetchLecture = async () => {\n        try {\n            const response = await fetch(`/api/lectures/${id}`);\n            if (!response.ok) throw new Error('Failed to fetch lecture');\n            const data = await response.json();\n            setLecture(data);\n        } catch (err) {\n            setError('Failed to load lecture');\n            console.error(err);\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    const fetchRevision = async () => {\n        try {\n            const response = await fetch(`/api/revisions/lecture/${id}`);\n            if (response.ok) {\n                const data = await response.json();\n                setRevision(data);\n            }\n        } catch (err) {\n            console.error('Failed to load revision data');\n        }\n    };\n\n    const handleComplete = async () => {\n        try {\n            const response = await fetch(`/api/lectures/${id}`, {\n                method: 'PUT',\n                headers: { 'Content-Type': 'application/json' },\n                body: JSON.stringify({ is_completed: !lecture.is_completed })\n            });\n            if (!response.ok) throw new Error('Failed to update lecture');\n            fetchLecture();\n        } catch (err) {\n            setError(err.message);\n        }\n    };\n\n    const handleDifficultyChange = async (difficulty) => {\n        try {\n            const response = await fetch(`/api/lectures/${id}`, {\n                method: 'PUT',\n                headers: { 'Content-Type': 'application/json' },\n                body: JSON.stringify({ difficulty })\n            });\n            if (!response.ok) throw new Error('Failed to update difficulty');\n            fetchLecture();\n        } catch (err) {\n            setError(err.message);\n        }\n    };\n\n    const handleMarkRevision = async () => {\n        try {\n            const response = await fetch(`/api/revisions/lecture/${id}`, {\n                method: 'POST'\n            });\n            if (!response.ok) throw new Error('Failed to mark revision');\n            const data = await response.json();\n            setRevision(data);\n        } catch (err) {\n            setError(err.message);\n        }\n    };\n\n    const formatDuration = (seconds) => {\n        if (!seconds) return 'Unknown';\n        const hours = Math.floor(seconds / 3600);\n        const minutes = Math.floor((seconds % 3600) / 60);\n        const secs = seconds % 60;\n\n        if (hours > 0) {\n            return `${hours}h ${minutes}m ${secs}s`;\n        } else if (minutes > 0) {\n            return `${minutes}m ${secs}s`;\n        } else {\n            return `${secs}s`;\n        }\n    };\n\n    if (loading) {\n        return <div className=\"loading\">Loading lecture...</div>;\n    }\n\n    if (!lecture) {\n        return <div className=\"error\">Lecture not found</div>;\n    }\n\n    // Determine if we show embed or message\n    const videoId = lecture.youtube_video_id;\n    const embedUrl = videoId\n        ? `https://www.youtube.com/embed/${videoId}`\n        : null;\n\n    return (\n        <div className=\"lecture-detail\">\n            <div className=\"container\">\n                <Link href={`/courses/${lecture.course_id}`} className=\"back-link\">\n                    ‚Üê Back to Course\n                </Link>\n\n                <div className=\"lecture-header-card\">\n                    <div className=\"lecture-title-section\">\n                        <h1 className=\"lecture-title\">{lecture.title}</h1>\n                        <div className=\"lecture-meta\">\n                            <span className={`difficulty-badge ${lecture.difficulty?.toLowerCase() || 'medium'}`}>\n                                {lecture.difficulty || 'Medium'}\n                            </span>\n                            {lecture.is_completed && (\n                                <span className=\"completed-badge\">‚úì Completed</span>\n                            )}\n                            {revision && revision.revision_count > 0 && (\n                                <span className=\"revision-badge\">\n                                    üîÑ Revised {revision.revision_count} time(s)\n                                </span>\n                            )}\n                        </div>\n                    </div>\n                    <div className=\"lecture-actions\">\n                        <button\n                            onClick={handleComplete}\n                            className={`btn ${lecture.is_completed ? 'btn-secondary' : 'btn-success'}`}\n                        >\n                            {lecture.is_completed ? 'Mark Incomplete' : 'Mark Complete'}\n                        </button>\n                        <button onClick={handleMarkRevision} className=\"btn btn-primary\">\n                            Mark as Revised\n                        </button>\n                        <select\n                            value={lecture.difficulty || 'Medium'}\n                            onChange={(e) => handleDifficultyChange(e.target.value)}\n                            className=\"form-select difficulty-select\"\n                        >\n                            <option value=\"Easy\">Easy</option>\n                            <option value=\"Medium\">Medium</option>\n                            <option value=\"Hard\">Hard</option>\n                        </select>\n                    </div>\n                </div>\n\n                {error && <div className=\"error\">{error}</div>}\n\n                {/* Tabs */}\n                <div className=\"tabs\">\n                    <button\n                        className={`tab ${activeTab === 'video' ? 'active' : ''}`}\n                        onClick={() => setActiveTab('video')}\n                    >\n                        üìπ Video\n                    </button>\n                    <button\n                        className={`tab ${activeTab === 'notes' ? 'active' : ''}`}\n                        onClick={() => setActiveTab('notes')}\n                    >\n                        üìù Notes\n                    </button>\n                    <button\n                        className={`tab ${activeTab === 'discussion' ? 'active' : ''}`}\n                        onClick={() => setActiveTab('discussion')}\n                    >\n                        üí¨ Discussion\n                    </button>\n                </div>\n\n                {/* Tab Content */}\n                <div className=\"tab-content\">\n                    {activeTab === 'video' && (\n                        <div className=\"card\">\n                            {embedUrl ? (\n                                <div className=\"video-container\">\n                                    <div id=\"youtube-player\"></div>\n                                    {lecture.duration_seconds > 0 && (\n                                        <p className=\"video-duration\">\n                                            Duration: {formatDuration(lecture.duration_seconds)}\n                                        </p>\n                                    )}\n                                </div>\n                            ) : (\n                                <div className=\"no-video\">\n                                    <p>No video URL provided for this lecture.</p>\n                                    {lecture.youtube_url && (\n                                        <a\n                                            href={lecture.youtube_url}\n                                            target=\"_blank\"\n                                            rel=\"noopener noreferrer\"\n                                            className=\"btn btn-primary\"\n                                        >\n                                            Open YouTube Link\n                                        </a>\n                                    )}\n                                </div>\n                            )}\n                        </div>\n                    )}\n\n                    {activeTab === 'notes' && (\n                        <div className=\"card\">\n                            <NotesEditor lectureId={id} />\n                        </div>\n                    )}\n\n                    {activeTab === 'discussion' && (\n                        <div className=\"card\">\n                            <DiscussionThread lectureId={id} />\n                        </div>\n                    )}\n                </div>\n            </div>\n        </div>\n    );\n}\n","'use client';\n\nimport { useState, useEffect } from 'react';\nimport './NotesEditor.css';\n\nconst NotesEditor = ({ lectureId }) => {\n    const [content, setContent] = useState('');\n    const [loading, setLoading] = useState(true);\n    const [saving, setSaving] = useState(false);\n    const [lastSaved, setLastSaved] = useState(null);\n\n    useEffect(() => {\n        fetchNotes();\n    }, [lectureId]);\n\n    const fetchNotes = async () => {\n        try {\n            const response = await fetch(`/api/notes/lecture/${lectureId}`);\n            if (!response.ok) throw new Error('Failed to fetch notes');\n            const data = await response.json();\n            setContent(data.content || '');\n        } catch (err) {\n            console.error('Failed to load notes');\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    const handleSave = async () => {\n        setSaving(true);\n        try {\n            const response = await fetch(`/api/notes/lecture/${lectureId}`, {\n                method: 'POST',\n                headers: { 'Content-Type': 'application/json' },\n                body: JSON.stringify({ content })\n            });\n            if (!response.ok) throw new Error('Failed to save notes');\n            setLastSaved(new Date());\n        } catch (err) {\n            alert('Failed to save notes');\n        } finally {\n            setSaving(false);\n        }\n    };\n\n    const handleAutoSave = () => {\n        // Auto-save after 2 seconds of no typing\n        const timeoutId = setTimeout(() => {\n            if (content.trim()) {\n                handleSave();\n            }\n        }, 2000);\n\n        return () => clearTimeout(timeoutId);\n    };\n\n    useEffect(() => {\n        if (!loading) {\n            const cleanup = handleAutoSave();\n            return cleanup;\n        }\n    }, [content, loading]);\n\n    if (loading) {\n        return <div className=\"loading\">Loading notes...</div>;\n    }\n\n    return (\n        <div className=\"notes-editor\">\n            <div className=\"notes-header\">\n                <h2>My Notes</h2>\n                <div className=\"notes-actions\">\n                    {lastSaved && (\n                        <span className=\"last-saved\">\n                            Saved {lastSaved.toLocaleTimeString()}\n                        </span>\n                    )}\n                    <button\n                        onClick={handleSave}\n                        className=\"btn btn-primary\"\n                        disabled={saving}\n                    >\n                        {saving ? 'Saving...' : 'Save Notes'}\n                    </button>\n                </div>\n            </div>\n            <textarea\n                className=\"notes-textarea\"\n                value={content}\n                onChange={(e) => setContent(e.target.value)}\n                placeholder=\"Write your notes here... You can use markdown formatting.\"\n                rows={20}\n            />\n            <p className=\"notes-hint\">\n                üí° Your notes are automatically saved. You can also click \"Save Notes\" to save manually.\n            </p>\n        </div>\n    );\n};\n\nexport default NotesEditor;\n","'use client';\n\nimport { useState, useEffect } from 'react';\nimport { useAuth } from '@/hooks/useAuth';\nimport './DiscussionThread.css';\n\nconst DiscussionThread = ({ lectureId }) => {\n    const [discussions, setDiscussions] = useState([]);\n    const [newComment, setNewComment] = useState('');\n    const [replyingTo, setReplyingTo] = useState(null);\n    const [replyContent, setReplyContent] = useState('');\n    const [loading, setLoading] = useState(true);\n    const { user } = useAuth();\n\n    useEffect(() => {\n        fetchDiscussions();\n    }, [lectureId]);\n\n    const fetchDiscussions = async () => {\n        try {\n            const response = await fetch(`/api/discussions/lecture/${lectureId}`);\n            if (!response.ok) throw new Error('Failed to load discussions');\n            const data = await response.json();\n            setDiscussions(data);\n        } catch (err) {\n            console.error('Failed to load discussions');\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    const handlePostComment = async (e) => {\n        e.preventDefault();\n        if (!newComment.trim()) return;\n\n        try {\n            const response = await fetch('/api/discussions', {\n                method: 'POST',\n                headers: { 'Content-Type': 'application/json' },\n                body: JSON.stringify({\n                    lecture_id: lectureId,\n                    content: newComment\n                })\n            });\n            if (!response.ok) throw new Error('Failed to post comment');\n\n            setNewComment('');\n            fetchDiscussions();\n        } catch (err) {\n            alert('Failed to post comment');\n        }\n    };\n\n    const handlePostReply = async (parentId) => {\n        if (!replyContent.trim()) return;\n\n        try {\n            const response = await fetch('/api/discussions', {\n                method: 'POST',\n                headers: { 'Content-Type': 'application/json' },\n                body: JSON.stringify({\n                    lecture_id: lectureId,\n                    parent_id: parentId,\n                    content: replyContent\n                })\n            });\n            if (!response.ok) throw new Error('Failed to post reply');\n\n            setReplyContent('');\n            setReplyingTo(null);\n            fetchDiscussions();\n        } catch (err) {\n            alert('Failed to post reply');\n        }\n    };\n\n    const handleDelete = async (discussionId) => {\n        if (!window.confirm('Are you sure you want to delete this comment?')) {\n            return;\n        }\n\n        try {\n            const response = await fetch(`/api/discussions/${discussionId}`, {\n                method: 'DELETE'\n            });\n            if (!response.ok) throw new Error('Failed to delete comment');\n\n            fetchDiscussions();\n        } catch (err) {\n            alert('Failed to delete comment');\n        }\n    };\n\n    if (loading) {\n        return <div className=\"loading\">Loading discussions...</div>;\n    }\n\n    return (\n        <div className=\"discussion-thread\">\n            <h2>Discussion</h2>\n            <p className=\"discussion-subtitle\">\n                Ask questions, share insights, and help your peers learn!\n            </p>\n\n            {/* Post new comment */}\n            <form onSubmit={handlePostComment} className=\"comment-form\">\n                <textarea\n                    className=\"form-textarea\"\n                    value={newComment}\n                    onChange={(e) => setNewComment(e.target.value)}\n                    placeholder=\"Write a comment...\"\n                    rows={3}\n                />\n                <button type=\"submit\" className=\"btn btn-primary\">\n                    Post Comment\n                </button>\n            </form>\n\n            {/* Comments list */}\n            <div className=\"comments-list\">\n                {discussions.length === 0 ? (\n                    <p className=\"no-comments\">No comments yet. Be the first to comment!</p>\n                ) : (\n                    discussions.map((comment) => (\n                        <div key={comment.id} className=\"comment-item\">\n                            <div className=\"comment-header\">\n                                <div className=\"comment-author\">\n                                    <strong>{comment.username}</strong>\n                                    <span className=\"comment-date\">\n                                        {new Date(comment.created_at).toLocaleString()}\n                                    </span>\n                                </div>\n                                {comment.user_id === user?.id && (\n                                    <button\n                                        onClick={() => handleDelete(comment.id)}\n                                        className=\"btn-delete-comment\"\n                                    >\n                                        Delete\n                                    </button>\n                                )}\n                            </div>\n                            <div className=\"comment-content\">{comment.content}</div>\n\n                            {/* Reply button */}\n                            <button\n                                onClick={() =>\n                                    setReplyingTo(replyingTo === comment.id ? null : comment.id)\n                                }\n                                className=\"btn-reply\"\n                            >\n                                {replyingTo === comment.id ? 'Cancel' : 'Reply'}\n                            </button>\n\n                            {/* Reply form */}\n                            {replyingTo === comment.id && (\n                                <div className=\"reply-form\">\n                                    <textarea\n                                        className=\"form-textarea\"\n                                        value={replyContent}\n                                        onChange={(e) => setReplyContent(e.target.value)}\n                                        placeholder=\"Write a reply...\"\n                                        rows={2}\n                                    />\n                                    <button\n                                        onClick={() => handlePostReply(comment.id)}\n                                        className=\"btn btn-primary btn-sm\"\n                                    >\n                                        Post Reply\n                                    </button>\n                                </div>\n                            )}\n\n                            {/* Replies */}\n                            {comment.replies && comment.replies.length > 0 && (\n                                <div className=\"replies-list\">\n                                    {comment.replies.map((reply) => (\n                                        <div key={reply.id} className=\"reply-item\">\n                                            <div className=\"reply-header\">\n                                                <strong>{reply.username}</strong>\n                                                <span className=\"reply-date\">\n                                                    {new Date(reply.created_at).toLocaleString()}\n                                                </span>\n                                                {reply.user_id === user?.id && (\n                                                    <button\n                                                        onClick={() => handleDelete(reply.id)}\n                                                        className=\"btn-delete-comment\"\n                                                    >\n                                                        Delete\n                                                    </button>\n                                                )}\n                                            </div>\n                                            <div className=\"reply-content\">{reply.content}</div>\n                                        </div>\n                                    ))}\n                                </div>\n                            )}\n                        </div>\n                    ))\n                )}\n            </div>\n        </div>\n    );\n};\n\nexport default DiscussionThread;\n"],"names":[],"mappings":"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"}