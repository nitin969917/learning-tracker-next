{"version":3,"sources":["../../../../app/%28authenticated%29/courses/page.js"],"sourcesContent":["'use client';\n\nimport { useState, useEffect } from 'react';\nimport Link from 'next/link';\nimport { useSearchParams, useRouter } from 'next/navigation';\nimport './courses.css';\n\nexport default function CoursesPage() {\n    const [courses, setCourses] = useState([]);\n    const [loading, setLoading] = useState(true);\n    const [error, setError] = useState('');\n    const [showForm, setShowForm] = useState(false);\n    const searchParams = useSearchParams();\n    const router = useRouter();\n\n    const [formData, setFormData] = useState({\n        title: '',\n        description: '',\n        course_type: 'Custom Subject',\n        playlist_url: ''\n    });\n\n    useEffect(() => {\n        fetchCourses();\n        if (searchParams.get('new') === 'true') {\n            setShowForm(true);\n        }\n    }, [searchParams]);\n\n    const fetchCourses = async () => {\n        try {\n            const response = await fetch('/api/courses');\n            if (!response.ok) throw new Error('Failed to fetch courses');\n            const data = await response.json();\n            setCourses(data);\n        } catch (err) {\n            setError('Failed to load courses');\n            console.error(err);\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    const handleSubmit = async (e) => {\n        e.preventDefault();\n        try {\n            const response = await fetch('/api/courses', {\n                method: 'POST',\n                headers: { 'Content-Type': 'application/json' },\n                body: JSON.stringify(formData)\n            });\n\n            const data = await response.json();\n\n            if (!response.ok) throw new Error(data.error || 'Failed to create course');\n\n            setFormData({\n                title: '',\n                description: '',\n                course_type: 'Custom Subject',\n                playlist_url: ''\n            });\n            setShowForm(false);\n            fetchCourses();\n            // Remove query param\n            router.replace('/courses');\n        } catch (err) {\n            setError(err.message);\n        }\n    };\n\n    const handleDelete = async (id) => {\n        if (!window.confirm('Are you sure you want to delete this course?')) {\n            return;\n        }\n        try {\n            const response = await fetch(`/api/courses/${id}`, {\n                method: 'DELETE'\n            });\n\n            if (!response.ok) {\n                const data = await response.json();\n                throw new Error(data.error || 'Failed to delete course');\n            }\n\n            fetchCourses();\n        } catch (err) {\n            setError(err.message);\n        }\n    };\n\n    const formatHours = (hours) => {\n        if (!hours) return '0h';\n        const h = Math.floor(hours);\n        const m = Math.floor((hours - h) * 60);\n        if (h > 0 && m > 0) {\n            return `${h}h ${m}m`;\n        } else if (h > 0) {\n            return `${h}h`;\n        } else {\n            return `${m}m`;\n        }\n    };\n\n    if (loading) {\n        return <div className=\"loading\">Loading courses...</div>;\n    }\n\n    return (\n        <div className=\"courses-page\">\n            <div className=\"container\">\n                <div className=\"page-header\">\n                    <h1 className=\"page-title\">My Courses</h1>\n                    <button\n                        onClick={() => setShowForm(!showForm)}\n                        className=\"btn btn-primary\"\n                    >\n                        {showForm ? 'Cancel' : '+ New Course'}\n                    </button>\n                </div>\n\n                {error && <div className=\"error\">{error}</div>}\n\n                {showForm && (\n                    <div className=\"card\">\n                        <h2>Create New Course</h2>\n                        <form onSubmit={handleSubmit}>\n                            <div className=\"form-group\">\n                                <label className=\"form-label\">Course Title *</label>\n                                <input\n                                    type=\"text\"\n                                    className=\"form-input\"\n                                    value={formData.title}\n                                    onChange={(e) =>\n                                        setFormData({ ...formData, title: e.target.value })\n                                    }\n                                    required\n                                />\n                            </div>\n\n                            <div className=\"form-group\">\n                                <label className=\"form-label\">Description</label>\n                                <textarea\n                                    className=\"form-textarea\"\n                                    value={formData.description}\n                                    onChange={(e) =>\n                                        setFormData({ ...formData, description: e.target.value })\n                                    }\n                                />\n                            </div>\n\n                            <div className=\"form-group\">\n                                <label className=\"form-label\">Course Type</label>\n                                <select\n                                    className=\"form-select\"\n                                    value={formData.course_type}\n                                    onChange={(e) =>\n                                        setFormData({ ...formData, course_type: e.target.value })\n                                    }\n                                >\n                                    <option value=\"Custom Subject\">Custom Subject</option>\n                                    <option value=\"YouTube Playlist\">YouTube Playlist</option>\n                                </select>\n                            </div>\n\n                            {formData.course_type === 'YouTube Playlist' && (\n                                <div className=\"form-group\">\n                                    <label className=\"form-label\">YouTube Playlist URL</label>\n                                    <input\n                                        type=\"text\"\n                                        className=\"form-input\"\n                                        value={formData.playlist_url}\n                                        onChange={(e) =>\n                                            setFormData({ ...formData, playlist_url: e.target.value })\n                                        }\n                                        placeholder=\"https://www.youtube.com/playlist?list=...\"\n                                        required\n                                    />\n                                    <p className=\"field-hint\">\n                                        Paste the full playlist link. All videos will be auto-added\n                                        as lectures (if the backend has a YouTube API key).\n                                    </p>\n                                </div>\n                            )}\n\n                            <button type=\"submit\" className=\"btn btn-primary\">\n                                Create Course\n                            </button>\n                        </form>\n                    </div>\n                )}\n\n                {courses.length === 0 ? (\n                    <div className=\"card\">\n                        <p className=\"no-data\">\n                            No courses yet. Create your first course to get started!\n                        </p>\n                    </div>\n                ) : (\n                    <div className=\"courses-grid\">\n                        {courses.map((course) => (\n                            <div key={course.id} className=\"course-card\">\n                                <div className=\"course-card-header\">\n                                    <h3>{course.title}</h3>\n                                    <button\n                                        onClick={() => handleDelete(course.id)}\n                                        className=\"btn-delete\"\n                                        title=\"Delete course\"\n                                    >\n                                        ×\n                                    </button>\n                                </div>\n                                <p className=\"course-description\">{course.description || 'No description'}</p>\n                                <div className=\"course-meta\">\n                                    <span className=\"course-type\">{course.course_type}</span>\n                                    <span className=\"course-lectures\">\n                                        {course.completed_lectures} / {course.total_lectures} lectures\n                                    </span>\n                                </div>\n                                {course.total_hours > 0 && (\n                                    <div className=\"course-hours-meta\">\n                                        <span className=\"course-hours\">\n                                            ⏱️ {formatHours(course.total_hours)} total\n                                            {course.completed_hours > 0 && (\n                                                <span className=\"completed-hours\">\n                                                    {' • '}\n                                                    {formatHours(course.completed_hours)} completed\n                                                </span>\n                                            )}\n                                        </span>\n                                    </div>\n                                )}\n                                <div className=\"course-progress-section\">\n                                    <div className=\"progress-bar\">\n                                        <div\n                                            className=\"progress-fill\"\n                                            style={{ width: `${course.completion_percentage}%` }}\n                                        ></div>\n                                    </div>\n                                    <span className=\"progress-text\">\n                                        {course.completion_percentage}% complete\n                                    </span>\n                                </div>\n                                <Link\n                                    href={`/courses/${course.id}`}\n                                    className=\"btn btn-primary btn-block\"\n                                >\n                                    View Course\n                                </Link>\n                            </div>\n                        ))}\n                    </div>\n                )}\n            </div>\n        </div>\n    );\n}\n"],"names":[],"mappings":"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"}