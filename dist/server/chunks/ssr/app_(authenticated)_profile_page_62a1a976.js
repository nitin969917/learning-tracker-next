module.exports=[21499,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(10850);function e(){let{user:a,logout:e,refetchUser:f}=(0,d.useAuth)(),[g,h]=(0,c.useState)(null),[i,j]=(0,c.useState)(!0),[k,l]=(0,c.useState)(!1),[m,n]=(0,c.useState)(!1),[o,p]=(0,c.useState)(""),[q,r]=(0,c.useState)(""),[s,t]=(0,c.useState)(null),[u,v]=(0,c.useState)(null),[w,x]=(0,c.useState)(!1),[y,z]=(0,c.useState)(!1),[A,B]=(0,c.useState)(""),[C,D]=(0,c.useState)({degree:"",institution:"",graduation_year:"",field_of_study:"",current_level:""});(0,c.useEffect)(()=>{E()},[]);let E=async()=>{try{let a=await fetch("/api/auth/profile");if(!a.ok)throw Error("Failed to load profile");let b=(await a.json()).user;h(b),B(b.username||""),D({degree:b.degree||"",institution:b.institution||"",graduation_year:b.graduation_year||"",field_of_study:b.field_of_study||"",current_level:b.current_level||""}),b.profile_picture?v(b.profile_picture):v(null)}catch(a){p("Failed to load profile"),console.error(a)}finally{j(!1)}},F=async()=>{if(window.confirm("Are you sure you want to remove your profile picture?")){x(!0),p("");try{let a=await fetch("/api/auth/profile/picture",{method:"DELETE"});if(!a.ok)throw Error("Failed to delete profile picture");let b=await a.json();h(b.user),v(null),t(null),r("Profile picture removed successfully!"),setTimeout(()=>r(""),3e3)}catch(a){p(a.message)}finally{x(!1)}}},G=async()=>{if(!s)return void p("Please select an image first");p(""),r(""),n(!0);try{let a=new FormData;a.append("profile_picture",s);let b=await fetch("/api/auth/profile",{method:"PUT",body:a});if(!b.ok)throw Error("Failed to upload image");let c=await b.json();h(c.user),t(null),c.user.profile_picture&&v(c.user.profile_picture),r("Profile picture updated successfully!"),setTimeout(()=>r(""),3e3)}catch(a){console.error("Upload error:",a),p(a.message)}finally{n(!1)}},H=async a=>{a.preventDefault(),p(""),r(""),n(!0);try{let a=new FormData;a.append("username",A),a.append("educationalDetails",JSON.stringify(C)),s&&a.append("profile_picture",s);let b=await fetch("/api/auth/profile",{method:"PUT",body:a});if(!b.ok)throw Error("Failed to update profile");let c=await b.json();h(c.user),l(!1),t(null),c.user.profile_picture&&v(c.user.profile_picture),r("Profile updated successfully!"),setTimeout(()=>r(""),3e3)}catch(a){console.error("Save error:",a),p(a.message)}finally{n(!1)}};return i?(0,b.jsx)("div",{className:"loading",children:"Loading profile..."}):g?(0,b.jsxs)("div",{className:"profile-page",children:[(0,b.jsxs)("div",{className:"container",children:[(0,b.jsx)("h1",{className:"page-title",children:"My Profile"}),(0,b.jsxs)("div",{className:"profile-container",children:[(0,b.jsxs)("div",{className:"profile-header",children:[(0,b.jsx)("div",{className:"profile-avatar-section",children:(0,b.jsxs)("div",{className:"profile-avatar",onClick:()=>z(!0),title:"Click to view profile picture",children:[u||g.profile_picture?(0,b.jsx)("img",{src:u||g.profile_picture,alt:g.username,className:"profile-image",onError:a=>{a.target.style.display="none"}}):null,!u&&!g.profile_picture&&(0,b.jsx)("div",{className:"avatar-placeholder",children:g.username.charAt(0).toUpperCase()})]})}),(0,b.jsxs)("div",{className:"profile-info",children:[(0,b.jsx)("h2",{children:g.username}),(0,b.jsx)("p",{className:"profile-email",children:g.email}),(0,b.jsx)("span",{className:`auth-badge ${g.auth_provider}`,children:"google"===g.auth_provider?"ðŸ” Google Account":"ðŸ“§ Email Account"}),(0,b.jsxs)("p",{className:"profile-joined",children:["Member since ",new Date(g.created_at).toLocaleDateString("en-US",{year:"numeric",month:"long"})]}),(0,b.jsx)("button",{onClick:e,className:"btn btn-danger",style:{marginTop:"1rem",padding:"0.5rem 1rem",fontSize:"0.9rem"},children:"Logout"})]})]}),(0,b.jsxs)("div",{className:"profile-section",children:[(0,b.jsxs)("div",{className:"section-header",children:[(0,b.jsx)("h3",{children:"Educational Details"}),!k&&(0,b.jsx)("button",{onClick:()=>l(!0),className:"btn btn-primary",children:"Edit Details"})]}),o&&(0,b.jsx)("div",{className:"error",children:o}),q&&(0,b.jsx)("div",{className:"success",children:q}),k?(0,b.jsxs)("form",{onSubmit:H,className:"educational-form",children:[(0,b.jsxs)("div",{className:"form-group",style:{marginBottom:"1.5rem"},children:[(0,b.jsx)("label",{className:"form-label",children:"Username"}),(0,b.jsx)("input",{type:"text",className:"form-input",value:A,onChange:a=>B(a.target.value),required:!0,minLength:3})]}),(0,b.jsxs)("div",{className:"form-row",children:[(0,b.jsxs)("div",{className:"form-group",children:[(0,b.jsx)("label",{className:"form-label",children:"Current Level"}),(0,b.jsxs)("select",{className:"form-select",value:C.current_level,onChange:a=>D({...C,current_level:a.target.value}),children:[(0,b.jsx)("option",{value:"",children:"Select Level"}),(0,b.jsx)("option",{value:"High School",children:"High School"}),(0,b.jsx)("option",{value:"Undergraduate",children:"Undergraduate"}),(0,b.jsx)("option",{value:"Graduate",children:"Graduate"}),(0,b.jsx)("option",{value:"Professional",children:"Professional"}),(0,b.jsx)("option",{value:"Other",children:"Other"})]})]}),(0,b.jsxs)("div",{className:"form-group",children:[(0,b.jsx)("label",{className:"form-label",children:"Degree"}),(0,b.jsx)("input",{type:"text",className:"form-input",placeholder:"e.g., B.Tech, M.Sc",value:C.degree,onChange:a=>D({...C,degree:a.target.value})})]})]}),(0,b.jsxs)("div",{className:"form-group",children:[(0,b.jsx)("label",{className:"form-label",children:"Institution"}),(0,b.jsx)("input",{type:"text",className:"form-input",placeholder:"University/College name",value:C.institution,onChange:a=>D({...C,institution:a.target.value})})]}),(0,b.jsxs)("div",{className:"form-row",children:[(0,b.jsxs)("div",{className:"form-group",children:[(0,b.jsx)("label",{className:"form-label",children:"Field of Study"}),(0,b.jsx)("input",{type:"text",className:"form-input",placeholder:"e.g., Computer Science",value:C.field_of_study,onChange:a=>D({...C,field_of_study:a.target.value})})]}),(0,b.jsxs)("div",{className:"form-group",children:[(0,b.jsx)("label",{className:"form-label",children:"Graduation Year"}),(0,b.jsx)("input",{type:"number",className:"form-input",placeholder:"e.g., 2024",min:"1950",max:"2100",value:C.graduation_year,onChange:a=>D({...C,graduation_year:a.target.value})})]})]}),(0,b.jsxs)("div",{className:"form-actions",children:[(0,b.jsx)("button",{type:"button",onClick:()=>{l(!1),p(""),r(""),t(null),g&&(B(g.username||""),D({degree:g.degree||"",institution:g.institution||"",graduation_year:g.graduation_year||"",field_of_study:g.field_of_study||"",current_level:g.current_level||""}),g.profile_picture?v(g.profile_picture):v(null))},className:"btn btn-secondary",disabled:m,children:"Cancel"}),(0,b.jsx)("button",{type:"submit",className:"btn btn-primary",disabled:m,children:m?"Saving...":"Save Changes"})]})]}):(0,b.jsx)("div",{className:"educational-details-view",children:g.current_level||g.degree||g.institution?(0,b.jsxs)("div",{className:"details-grid",children:[g.current_level&&(0,b.jsxs)("div",{className:"detail-item",children:[(0,b.jsx)("span",{className:"detail-label",children:"Current Level:"}),(0,b.jsx)("span",{className:"detail-value",children:g.current_level})]}),g.degree&&(0,b.jsxs)("div",{className:"detail-item",children:[(0,b.jsx)("span",{className:"detail-label",children:"Degree:"}),(0,b.jsx)("span",{className:"detail-value",children:g.degree})]}),g.institution&&(0,b.jsxs)("div",{className:"detail-item",children:[(0,b.jsx)("span",{className:"detail-label",children:"Institution:"}),(0,b.jsx)("span",{className:"detail-value",children:g.institution})]}),g.field_of_study&&(0,b.jsxs)("div",{className:"detail-item",children:[(0,b.jsx)("span",{className:"detail-label",children:"Field of Study:"}),(0,b.jsx)("span",{className:"detail-value",children:g.field_of_study})]}),g.graduation_year&&(0,b.jsxs)("div",{className:"detail-item",children:[(0,b.jsx)("span",{className:"detail-label",children:"Graduation Year:"}),(0,b.jsx)("span",{className:"detail-value",children:g.graduation_year})]})]}):(0,b.jsx)("p",{className:"no-details",children:'No educational details added yet. Click "Edit Details" to add your information.'})})]})]})]}),y&&(0,b.jsx)("div",{className:"profile-image-modal-overlay",onClick:()=>z(!1),children:(0,b.jsxs)("div",{className:"profile-image-modal",onClick:a=>a.stopPropagation(),children:[(0,b.jsxs)("div",{className:"modal-header",children:[(0,b.jsx)("h3",{children:"Profile photo"}),(0,b.jsx)("button",{className:"close-btn",onClick:()=>z(!1),children:"âœ•"})]}),(0,b.jsx)("div",{className:"modal-body",children:u||g.profile_picture?(0,b.jsx)("img",{src:u||g.profile_picture,alt:g.username,className:"modal-image"}):(0,b.jsx)("div",{className:"modal-placeholder",children:g.username.charAt(0).toUpperCase()})}),(0,b.jsx)("div",{className:"modal-footer",children:(0,b.jsxs)("div",{className:"modal-actions",children:[(0,b.jsxs)("label",{htmlFor:"modal-image-upload",className:"modal-action-btn",children:[(0,b.jsx)("span",{className:"icon",children:"âœŽ"}),(0,b.jsx)("span",{className:"text",children:s?"Change Photo":"Update Photo"})]}),(0,b.jsx)("input",{id:"modal-image-upload",type:"file",accept:"image/jpeg,image/jpg,image/png,image/gif,image/webp",onChange:a=>{let b=a.target.files[0];if(b){if(!b.type.match("image.*"))return void p("Please select an image file");if(b.size>5242880)return void p("Image size must be less than 5MB");t(b);let a=new FileReader;a.onloadend=()=>{v(a.result)},a.readAsDataURL(b)}},style:{display:"none"}}),s&&(0,b.jsxs)("button",{className:"modal-action-btn save",onClick:G,disabled:m,children:[(0,b.jsx)("span",{className:"icon",children:"ðŸ’¾"}),(0,b.jsx)("span",{className:"text",children:m?"Saving...":"Save"})]}),(g.profile_picture||u)&&(0,b.jsxs)("button",{className:"modal-action-btn delete",onClick:F,disabled:w,children:[(0,b.jsx)("span",{className:"icon",children:"ðŸ—‘"}),(0,b.jsx)("span",{className:"text",children:"Delete"})]})]})})]})})]}):(0,b.jsx)("div",{className:"error",children:"User not found"})}a.s(["default",()=>e])}];

//# sourceMappingURL=app_%28authenticated%29_profile_page_62a1a976.js.map